---
title: "rix: environnements de développement reproductibles pour développeurs R"
author: "Bruno Rodrigues"
format:
  revealjs:
    embed-resources: true
    slide-number: true
    theme: solarized
    incremental: true
execute:
  echo: true
---

## Qui suis-je?

- Bruno Rodrigues, responsable des départements "statistiques" et "stratégie de données" du Ministère 
  de la Recherche et de l’Enseignement supérieur au Luxembourg

- Utilisateur de R depuis 2009

- Cette présentation est disponible sur le lien suivant [https://is.gd/nix_rr_2024](https://is.gd/nix_rr_2024)

- Code source disponible ici: [https://github.com/b-rodrigues/rr_2024/blob/main/presentation/pres_rr_2024.qmd](https://github.com/b-rodrigues/rr_2024/blob/main/presentation/pres_rr_2024.qmd)

## Le(s) problème(s)

- Collaboration sur environnements hétérogènes
- Reproductibilité des projets
- Déployer le même environnement "partout"

## La solution en vogue

- Docker + `{renv}` ou autre tant qu'on arrive à installer
- les mêmes paquets R
- la même version de R
- les mêmes dépendances "système" (`gdal` pour `{terra}` par exemple)

## Le gestionnaire de paquets Nix (1/3)

- Pas une alternative à Docker!
- Mais permet de résoudre les mêmes problèmes
- La promesse de Nix:

. . .

*Installe tous les logiciels nécessaires (R, paquets R, librairies de développement,
etc) de manière totalement reproductible et sur n'importe quelle plate-forme en écrivant
une seule expression dans le langage Nix.*

## Le gestionnaire de paquets Nix (2/3)

- Avec Nix, on configure une fois et on exécute partout!
- Partout: ordinateur ou serveur: Windows (via WSL2), Linux (même Android) ou macOS
- Pour R: 99% des paquets CRAN + Bioconductor disponibles

## Le gestionnaire de paquets Nix (3/3)

- Nix: gestionnaire de paquets *fonctionnel* (inspiré du lambda-calcul)

. . .

![Attention aux effets de bord!](img/procedural_vs_fonctional.png)

## Un gestionnaire de paquets fonctionnel et déclaratif

```
let
  pkgs = import (fetchTarball "https://github.com/NixOS/nixpkgs/archive/976fa3369d722e76f37c77493d99829540d43845.tar.gz") {};
  system_packages = builtins.attrValues {
    inherit (pkgs) R ;
  };
in
  pkgs.mkShell {
    buildInputs = [ system_packages ];
    shellHook = "R --vanilla";
  }
```


